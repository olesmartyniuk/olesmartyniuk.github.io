<!DOCTYPE html>



<html lang="en" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    <meta name="pv-cache-enabled" content="false">

    
  

  <title>
      LINQ. Overview | 
    Martyniuk Oleksandr
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
-->



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- JavaScripts -->

  <script src="/assets/js/dist/lang-detector.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Martyniuk Oleksandr</a>
    </div>

    <div class="site-subtitle font-italic">.NET Engineer</div>

    <!-- language -->

    
    
    <div class="site-title mt-0">               
              
        <a href="/uk/posts/linq-overview/" title="Українською">
          <img src="/assets/img/sample/ukrainian.png" width="40px" height="40px"/>
        </a>  
                    
    </div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">    
    <!-- home -->
    
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    

      

      <li class="nav-item">
        <a href="/categories/" class="nav-link">
          <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
          <span>CATEGORIES</span>
        </a>
      </li> <!-- .nav-item -->
    

      

      <li class="nav-item">
        <a href="/tags/" class="nav-link">
          <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
          <span>TAGS</span>
        </a>
      </li> <!-- .nav-item -->
    

      

      <li class="nav-item">
        <a href="/archives/" class="nav-link">
          <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
          <span>ARCHIVES</span>
        </a>
      </li> <!-- .nav-item -->
    

      

      <li class="nav-item">
        <a href="/projects/" class="nav-link">
          <i class="fa-fw fas fa-tasks ml-xl-3 mr-xl-3 unloaded"></i>
          <span>PROJECTS</span>
        </a>
      </li> <!-- .nav-item -->
    

      

      <li class="nav-item">
        <a href="/about/" class="nav-link">
          <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
          <span>ABOUT</span>
        </a>
      </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/alexmartyniuk" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/alexmartyniuk" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['alexander.martinyuk','gmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/">
            Posts
          </a>
        </span>

        

      

        
          <span></span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>LINQ. Overview</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <!--
  Date format snippet
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Fri, May  1, 2020,  6:35 PM +0300"
  >

  
  

  
    May  1, 2020
  

  <i class="unloaded">2020-05-01T18:35:30+03:00</i>

</span>
          
        </div>

        <div>       
          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1747 words">9 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/2020-05-01-linq-overview/Cover.png" alt="Illustration" /></p>

<p>In this article, we will look into LINQ as an important component of the .NET framework, its history, and its role. Why it was created and how to use this tool in practice. Finally, we will look at examples in C# that give an idea of ​​what LINQ is.</p>

<p><strong>LINQ</strong> - (<em>language integrated query</em>) - a query data language, which is integrated into C#. The data can be collections of objects in memory, XML files, database tables, web services, etc. But why do we need another tool? C# already allows us to query structured data? It’s all about how to do this in the easiest way. In order to explain what the ease of LINQ is, it is necessary to consider the difference between declarative and imperative programming.</p>

<h2 id="imperative-and-declarative-programming">Imperative and declarative programming</h2>
<p>The first programming languages ​​used a clear order of commands. This is very handy when dealing with CPU registers and direct memory access. Languages ​​such as C and Assembler use memory allocation operators, assignments, conditional operators, and routines. All these are features of the imperative approach. In the imperative approach, the program is a sequence of clear commands and the computer executes these commands one by one.</p>

<p>Imperative programming languages ​​include:</p>
<ul>
  <li>C#</li>
  <li>Python</li>
  <li>JavaScript</li>
  <li>Go</li>
</ul>

<p>All of these languages ​​are based on variables, assignment operators, and routines. This approach is close to how a computer works, but far from human language, familiar to all of us. It is more convenient for people to declare what they want than to describe a clear algorithm for achieving this goal.</p>

<p>Therefore, the imperative approach is opposed to the declarative. Its main feature is that the step-by-step algorithm is not specified. Instead, the data source is specified, the desired result is described and a set of rules by which this result will be achieved. Execution of the request is entrusted to the interpreter, who is able to translate it into a form convenient for the computer, ie in the imperative form.</p>

<p>Declarative languages ​​include:</p>
<ul>
  <li>SQL</li>
  <li>Regular Expressions</li>
  <li>XSLT Transformation</li>
  <li>Gremlin</li>
</ul>

<p>The main purpose of creating LINQ was to introduce a declarative approach to data processing in .NET</p>

<h2 id="comparison-of-approaches">Comparison of approaches</h2>

<p>Consider two examples, first imperative using a loop and then declarative using LINQ.</p>

<p>As a test data set, take a list of superheroes, each with a name, year of birth (or first mention in comics), and the name of the series where he first appeared.</p>

<p>So, let’s create a new console program in .NET Core:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">&gt;</span> dotnet new console <span class="nt">-n</span>  LinqTestApp
The template <span class="s2">"Console Application"</span> was created successfully.
</pre></td></tr></tbody></table></code></div></div>
<p>Define the superhero class and add test data.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="k">private</span> <span class="k">class</span> <span class="nc">Hero</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">YearOfBirth</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Comics</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Hero</span><span class="p">&gt;</span> <span class="n">_heroes</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Hero</span><span class="p">&gt;</span> 
<span class="p">{</span>
    <span class="k">new</span> <span class="n">Hero</span>
    <span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="s">"Superman"</span><span class="p">,</span>
        <span class="n">YearOfBirth</span> <span class="p">=</span> <span class="m">1938</span><span class="p">,</span>
        <span class="n">Comics</span> <span class="p">=</span> <span class="s">"Action Comics"</span>
    <span class="p">},</span>
    <span class="k">new</span> <span class="n">Hero</span>
    <span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="s">"Batman"</span><span class="p">,</span>
        <span class="n">YearOfBirth</span> <span class="p">=</span> <span class="m">1938</span><span class="p">,</span>
        <span class="n">Comics</span> <span class="p">=</span> <span class="s">"Detective Comics"</span>
    <span class="p">},</span>
    <span class="k">new</span> <span class="n">Hero</span>
    <span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="s">"Captain America"</span><span class="p">,</span>
        <span class="n">YearOfBirth</span> <span class="p">=</span> <span class="m">1941</span><span class="p">,</span>
        <span class="n">Comics</span> <span class="p">=</span> <span class="s">"Captain America Comics"</span>
    <span class="p">},</span>
    <span class="k">new</span> <span class="n">Hero</span>
    <span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="s">"Ironman"</span><span class="p">,</span>
        <span class="n">YearOfBirth</span> <span class="p">=</span> <span class="m">1963</span><span class="p">,</span>
        <span class="n">Comics</span> <span class="p">=</span> <span class="s">"Tales of Suspense"</span>
    <span class="p">},</span>
    <span class="k">new</span> <span class="n">Hero</span>
    <span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="s">"Spiderman"</span><span class="p">,</span>
        <span class="n">YearOfBirth</span> <span class="p">=</span> <span class="m">1963</span><span class="p">,</span>
        <span class="n">Comics</span> <span class="p">=</span> <span class="s">"Amazing Fantasy"</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Suppose our task is to select those superheroes who have the word “man” in their name and display their names in alphabetical order. That is, we must get the names of all the heroes (except Captain America) in sorted form.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>Batman
Ironman
Spiderman
Superman
</pre></td></tr></tbody></table></code></div></div>

<p>With the imperative approach, we need to create a list in which we will add the names, then go through the list of heroes and add to the created list only those whose names contain the word “man”. After that it is necessary to sort the received list and to display:</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">heroNames</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">hero</span> <span class="k">in</span> <span class="n">_heroes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"man"</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">heroNames</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">heroNames</span><span class="p">.</span><span class="nf">Sort</span><span class="p">();</span>

    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">heroName</span> <span class="k">in</span> <span class="n">heroNames</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">heroName</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Now let’s solve the same problem, but with LINQ.</p>
<blockquote>
  <p>Don’t forget to use the namespace System.Linq</p>
</blockquote>

<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">heroNames</span> <span class="p">=</span>
        <span class="k">from</span> <span class="n">hero</span> <span class="k">in</span> <span class="n">_heroes</span>
        <span class="k">where</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"man"</span><span class="p">)</span>
        <span class="k">orderby</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span>
        <span class="k">select</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">;</span>

    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">hero</span> <span class="k">in</span> <span class="n">heroNames</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The program has become 5 lines shorter and easier to understand because the data is sampled in a language very similar to human and can be translated to English as “Choose the names of heroes with “Man” in the name and sort them by the name”.</p>

<p>Let’s understand what this code does.</p>

<p><code class="language-plaintext highlighter-rouge">from hero in _heroes</code> specifies the data source. We have the list <code class="language-plaintext highlighter-rouge">_heroes</code>. We will refer to each item in the list in the expression through a variable <code class="language-plaintext highlighter-rouge">hero</code>. And although we did not specify its type anywhere, the expression remains strictly typed, because the compiler can output the type from the collection type.</p>

<p><code class="language-plaintext highlighter-rouge">where hero.Name.Contains</code> specifies the condition for filtering. If the element meets the condition, it is passed on. Thus, all subsequent operators in the expression will already work with the filtered list. The operator <code class="language-plaintext highlighter-rouge">where</code> also called the filter operator.</p>

<p><code class="language-plaintext highlighter-rouge">orderby hero.Name</code> specifies the field and sort method.</p>

<p><code class="language-plaintext highlighter-rouge">select hero.Name</code> sets the value to be included in the resulting sample. Since we are only interested in the names of the heroes, we specify the Name field here. This operator specifies the type of result, so in our case, it will be <code class="language-plaintext highlighter-rouge">IEnumerable&lt;string&gt;</code>. This operator is also called the projection operator because it converts the data containing the source into the form we need for a specific task.</p>

<h2 id="expansion-methods">Expansion methods</h2>
<p>It is worth noting that although the LINQ syntax is significantly different from the C# syntax, under the hood LINQ still uses C# extension methods, so the above query can be rewritten in a more familiar object-oriented style:</p>
<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">heroNames</span> <span class="p">=</span> <span class="n">_heroes</span>
    <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">hero</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"man"</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">hero</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">hero</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>
<p>This syntax is called extension syntax (or lambda syntax) and can be used in conjunction with LINQ query syntax. Often when we talk about LINQ we mean extension methods because they are implemented in the namespace <code class="language-plaintext highlighter-rouge">System.Linq</code> and they are part of LINQ itself. For the most part, these methods extend the IEnumerable interface and they are the basis for implementing LINQ. This may be confusing at first, but LINQ is not only the syntax <code class="language-plaintext highlighter-rouge">from ... in ... select</code>, but also the syntax of extension methods.</p>

<p>Because extension methods are the basis for implementing LINQ, they are more powerful than query syntax. For example, the method <code class="language-plaintext highlighter-rouge">Where</code> has an overloaded version in which when filtering the index of the item in the source collection is available. This index can be used in the formation of a logical expression (predicate).</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>    <span class="p">...</span>
    <span class="p">.</span><span class="nf">Where</span><span class="p">((</span><span class="n">hero</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"man"</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">index</span> <span class="p">&gt;</span> <span class="m">2</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>But this index is not available if we use query syntax from … in … select.</p>

<p>Scalar functions Count, Max, Sum, and other methods (such as Intersect) also are not available when using query syntax.</p>

<p>With extension methods, we can break a LINQ expression into several parts and combine them according to a condition, which is impossible for query syntax. Example:</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="n">_heroes</span><span class="p">.</span><span class="nf">Where</span><span class="p">((</span><span class="n">hero</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"man"</span><span class="p">));</span>

<span class="k">if</span> <span class="p">(</span><span class="n">shouldBeSorted</span><span class="p">)</span>
    <span class="n">query</span> <span class="p">=</span> <span class="n">query</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">hero</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">heroNames</span> <span class="p">=</span> <span class="n">query</span>
    <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">hero</span> <span class="p">=&gt;</span> <span class="n">hero</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We add sorting only if the input parameter <code class="language-plaintext highlighter-rouge">shouldBeSorted</code> is equal to <code class="language-plaintext highlighter-rouge">true</code>. Using the syntax of the query, we need to write the expression twice depending on the condition: in the first case with sorting, and in the second - without it.</p>

<blockquote>
  <p>In this article we will use the syntax of extension methods because it is more powerful and allows us to show the full potential of LINQ.</p>
</blockquote>

<h2 id="history">History</h2>
<p>In 2007, C# had version 2.0 and no LINQ. Data processing was done in an imperative style. At that time, Python 2.4 and JavaScript 1.6 already existed, which had powerful built-in tools for working with collections, such as <code class="language-plaintext highlighter-rouge">filter</code>, <code class="language-plaintext highlighter-rouge">map</code>, and <code class="language-plaintext highlighter-rouge">reduce</code>. C# was less powerful when it came to working with collections, and it had to be changed.</p>

<p>In the fall of 2007, Microsoft released the .NET Framework 3.5, which featured significant innovations. These changes made it possible to create LINQ and raise the C # version to 3.0. Among the innovations were:</p>

<p><strong>Lambda</strong> expressions made it possible to easily define predicates for methods such as Where, Select as <code class="language-plaintext highlighter-rouge">() =&gt; {...}</code>.</p>

<p><strong>Anonymous types</strong> allowed the creation of objects of arbitrary structure on the fly and removed the need to declare a type for the result of the LINQ expression.</p>

<p><strong>Expression trees</strong> made it possible to store predicates as objects, on the basis of which different data providers could generate their own optimized query. This applies to LINQ to SQL or LINQ to XPath.</p>

<p><strong>Expansion methods</strong> have allowed expanding existing types without modifying and imitating them. This allowed LINQ to be applied to a large number of third-party types that support <code class="language-plaintext highlighter-rouge">IEnumerable</code> or <code class="language-plaintext highlighter-rouge">IQueryable</code>.</p>

<p><strong>Object and collection initializers</strong> allowed objects to be created and their fields to be initialized without the use of constructors, which greatly simplified the syntax for LINQ projection methods when creating new objects as part of an expression.</p>

<p><strong>Declaring variables as <code class="language-plaintext highlighter-rouge">var</code></strong> greatly simplified the query result type determination and made it possible to return anonymous data from a LINQ expression.
All these features have taken C # and the .NET platform to a new level and allowed Microsoft to create LINQ. Since its release, it has become an integral part of the .NET framework and as a library for working with data is not inferior, and in many aspects surpasses the built-in tools of other languages, such as Java, Python, Go, and JavaScript.</p>

<p>In the following articles, we will consider in more detail all the main aspects of working with LINQ. You will find that it is not only a convenient but also quite effective and mature tool.</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/programming/'>Programming</a>,
            <a href='/categories/net/'>.NET</a>
        </div>
        

        <!-- tags -->
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          

          

        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  

  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">        
      
        
        <a class="post-tag" href="/tags/c/">C#</a>
      
        
        <a class="post-tag" href="/tags/net/">.NET</a>
      
        
        <a class="post-tag" href="/tags/acid/">ACID</a>
      
        
        <a class="post-tag" href="/tags/algorithms/">algorithms</a>
      
        
        <a class="post-tag" href="/tags/aws/">AWS</a>
      
        
        <a class="post-tag" href="/tags/codility-com/">codility.com</a>
      
        
        <a class="post-tag" href="/tags/dynamodb/">DynamoDB</a>
      
        
        <a class="post-tag" href="/tags/experience/">experience</a>
      
        
        <a class="post-tag" href="/tags/integration-tests/">integration tests</a>
      
        
        <a class="post-tag" href="/tags/linq/">LINQ</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

          

    

    
      <!--
  The Disqus lazy loading.
  Powered by: <https://github.com/osvaldasvalutis/disqusLoader.js>
-->

<div id="disqus" class="pt-2 pb-2">
  <p class="text-center text-muted small pb-5">
    Loading comments from <a href="https://disqus.com/">Disqus</a> ...
  </p>
</div>

<script src="/assets/js/lib/jquery.disqusloader.min.js"></script>
<script>
  const options = {
    scriptUrl: '//martyniuk.disqus.com/embed.js',

    disqusConfig: function() {
      this.page.title = '';
      this.page.url = 'http://0.0.0.0:4000/posts/linq-overview/';
      this.page.identifier = '/posts/linq-overview/';
    }
  };

  $.disqusLoader('#disqus', options);
</script>

    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



  <!--
  image lazy load: https://github.com/ApoorvSaxena/lozad.js
-->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

<script type="text/javascript">
  const imgs = document.querySelectorAll('.post-content img');
  const observer = lozad(imgs);
  observer.observe();
</script>




        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    

    <div class="footer-left">

    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/c/">C#</a>
      
        
        <a class="post-tag" href="/tags/net/">.NET</a>
      
        
        <a class="post-tag" href="/tags/acid/">ACID</a>
      
        
        <a class="post-tag" href="/tags/algorithms/">algorithms</a>
      
        
        <a class="post-tag" href="/tags/aws/">AWS</a>
      
        
        <a class="post-tag" href="/tags/codility-com/">codility.com</a>
      
        
        <a class="post-tag" href="/tags/dynamodb/">DynamoDB</a>
      
        
        <a class="post-tag" href="/tags/experience/">experience</a>
      
        
        <a class="post-tag" href="/tags/integration-tests/">integration tests</a>
      
        
        <a class="post-tag" href="/tags/linq/">LINQ</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

